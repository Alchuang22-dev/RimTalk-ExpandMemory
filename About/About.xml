<?xml version="1.0" encoding="utf-8"?>
<ModMetaData>
	<packageId>cj.rimtalk.expandmemory</packageId>
	<name>RimTalk - Expand Memory</name>
	<author>SANGUO</author>
	<supportedVersions>
		<li>1.5</li>
		<li>1.6</li>
	</supportedVersions>
	<modVersion>2.4.3</modVersion>
	<url>https://github.com/sanguodxj-byte/RimTalk-ExpandMemory</url>
	
	<description>[h1]RimTalk - Expand Memory[/h1]

[b]为 RimWorld AI 对话提供智能记忆与常识管理系统！[/b]
Intelligent Memory &amp; Knowledge Management System for RimWorld AI conversations!

[img]https://i.imgur.com/yourimageurl.png[/img]

[hr][/hr]

[h1]🌟 核心功能 Core Features[/h1]

[h2]📝 四层记忆架构 (Four-Layer Memory)[/h2]
仿照人类记忆系统设计的四层记忆管理：
[list]
[*][b]ABM[/b] - 超短期记忆（Active Memory Buffer）
    ├─ 当前对话上下文，自动管理
    └─ 容量：6条固定
[*][b]SCM[/b] - 短期记忆（Situational Context Memory）
    ├─ 最近发生的事件和对话
    └─ 容量：10-50条可调
[*][b]ELS[/b] - 中期记忆（Event Log Summary）
    ├─ AI智能总结的重要事件
    └─ 容量：20-100条可调
[*][b]CLPA[/b] - 长期记忆（Core Long-term Personal Archive）
    ├─ 核心人设和关键经历
    └─ 容量：无限制
[/list]

[h2]🎯 动态记忆注入 (Dynamic Injection)[/h2]
类似 CharacterAI 的智能注入系统：
[list]
[*][b]多维度评分[/b]：时间衰减(30%) + 重要性(30%) + 关键词匹配(40%)
[*][b]智能选择[/b]：自动选择最相关的1-20条记忆注入
[*][b]实时调整[/b]：根据对话主题动态调整注入内容
[*][b]性能优化[/b]：Jaccard相似度算法，延迟&lt;2ms
[*][b]阈值过滤[/b]：低分记忆自动过滤，减少Token消耗
[/list]

[h2]📚 通用常识库 (Common Knowledge Library)[/h2]
管理世界观、背景知识、规则等通用信息：
[list]
[*][b]纯文本格式[/b]：[标签|重要性]内容，简单易用
[*][b]动态注入[/b]：基于关键词相关性智能选择
[*][b]可视化管理[/b]：完整的UI界面，支持增删改查
[*][b]批量导入导出[/b]：方便备份和分享
[*][b]重要性参数[/b]：0.0-1.0调节注入优先级
[*][b]启用/禁用[/b]：灵活控制每条常识
[/list]

[h2]👥 Pawn状态常识自动生成 (v2.4.0+)[/h2]
防止新人错误谈论不属于自己的经历：
[list]
[*][b]自动检测[/b]：殖民者加入时间
[*][b]动态标签[/b]：新成员、老成员等7个时间段
[*][b]种族信息[/b]：自动包含人类、美狐族等种族
[*][b]重要性递减[/b]：新人0.95 → 老人0.60
[*][b]自动更新[/b]：随时间推移自动调整状态
[/list]

[h2]🔍 调试预览器 (Injection Preview) v2.4.3[/h2]
实时查看注入内容，优化调试体验：
[list]
[*][b]实时预览[/b]：查看确切的注入内容
[*][b]详细评分[/b]：每条记忆/常识的评分明细
[*][b]关键词分析[/b]：提取的关键词和匹配结果
[*][b]上下文输入[/b]：模拟不同对话场景
[*][b]读取上次输入[/b]：一键读取RimTalk最后对话（v2.4.3新增）
[*][b]角色选择[/b]：支持当前角色+目标角色双选择
[*][b]JSON模拟[/b]：完整的API请求结构预览
[*][b]Token估算[/b]：预估API成本
[/list]

[h2]🤖 AI提供商支持 (AI Provider Support)[/h2]
支持多个主流AI服务：
[list]
[*][b]OpenAI[/b]：GPT-3.5-turbo, GPT-4, GPT-4-turbo
[*][b]DeepSeek[/b]：国产AI，低成本，中文优化 ⭐推荐
[*][b]Google Gemini[/b]：gemini-pro, gemini-1.5-flash，免费额度大
[*][b]本地AI[/b]：支持Ollama、LM Studio等OpenAPI兼容服务
[*][b]双配置[/b]：可选RimTalk配置或独立配置
[/list]

[h2]⚙️ 高级功能 (Advanced Features)[/h2]
[list]
[*][b]对话缓存系统[/b]：减少API调用，提升响应速度
[*][b]AI自动总结[/b]：每日自动整理短期记忆
[*][b]智能归档[/b]：定期归档重要记忆到长期
[*][b]记忆衰减[/b]：模拟人类遗忘曲线
[*][b]手动总结/归档[/b]：UI直接操作
[*][b]多语言支持[/b]：中文、英文、日文等
[*][b]完整API[/b]：供其他Mod集成调用
[/list]

[hr][/hr]

[h1]📖 使用方法 How to Use[/h1]

[h2]基础配置 Basic Setup[/h2]
[olist]
[*]确保安装 [b]Harmony[/b] 前置Mod
[*]启用 [b]RimTalk - Expand Memory[/b]
[*]（可选）安装 [b]RimTalk[/b] 获得完整AI对话功能
[*]进入游戏，打开 [b]Mod设置[/b]
[*]配置常识库和动态注入参数
[/olist]

[h2]推荐配置 Recommended Settings[/h2]
[code]
动态注入模式：✅ 启用（推荐）
最大注入记忆数：8-10 条
最大注入常识数：3-5 条
记忆评分阈值：0.15 (15%)
常识评分阈值：0.10 (10%)

权重配置：
├─ 时间衰减：30%
├─ 重要性：30%
└─ 关键词匹配：40%
[/code]

[h2]快速开始 Quick Start[/h2]
[olist]
[*]打开 [b]Mod设置 → RimTalk-Expand Memory[/b]
[*]点击 [b]"打开常识库管理"[/b]
[*]点击 [b]"导入"[/b]，粘贴以下示例：
[code]
[世界观|0.9]这是边缘世界，科技倒退到工业时代
[规则|0.8]回复控制在80字以内，口语化表达
[危机|0.7]海盗会定期袭击，需要防御准备
[/code]
[*]点击 [b]"打开注入内容预览器"[/b] 查看效果
[*]（可选）启用 [b]Pawn状态常识自动生成[/b]
[/olist]

[hr][/hr]

[h1]🎯 使用场景 Use Cases[/h1]

[h2]场景1：深度角色扮演[/h2]
为每个殖民者创建独特的记忆和背景：
[quote]
Alice是个乐观的厨师，拥有烹饪天赋
→ 对话时会自然提起烹饪经历
→ AI会基于她的记忆生成相关对话
[/quote]

[h2]场景2：自定义世界观[/h2]
构建独特的游戏世界设定：
[quote]
[世界观] 末日后500年，魔法重现
[历史] 100年前的大战毁灭了旧文明
[威胁] 机械巨兽在废墟中游荡
→ AI会遵循这些设定生成对话
[/quote]

[h2]场景3：优化Token消耗[/h2]
精确控制注入内容，降低API成本：
[quote]
最小配置：记忆1条 + 常识1条 ≈ 40 tokens
中等配置：记忆8条 + 常识3条 ≈ 220 tokens
最大配置：记忆20条 + 常识10条 ≈ 600 tokens
[/quote]

[hr][/hr]

[h1]🔧 兼容性 Compatibility[/h1]

[h2]必需 Required[/h2]
[list]
[*]✅ RimWorld 1.5+ / 1.6+
[*]✅ Harmony
[/list]

[h2]推荐 Recommended[/h2]
[list]
[*]⭐ RimTalk（强烈推荐，获得完整AI对话功能）
[/list]

[h2]可选 Optional[/h2]
[list]
[*]✅ 互动气泡（Interaction Bubbles）
[*]✅ Psychology
[*]✅ 其他AI Mod
[/list]

[h2]加载顺序 Load Order[/h2]
[code]
1. Core
2. Harmony
3. RimTalk（如有）
4. RimTalk - Expand Memory ← 本Mod
5. 其他Mod
[/code]

[hr][/hr]

[h1]📊 性能数据 Performance[/h1]

[h2]Token消耗对比[/h2]
[table]
[tr]
[th]配置[/th]
[th]Token[/th]
[th]场景[/th]
[/tr]
[tr]
[td]最小(1+1)[/td]
[td]~40[/td]
[td]极简对话[/td]
[/tr]
[tr]
[td]低(3+2)[/td]
[td]~100[/td]
[td]性能优先[/td]
[/tr]
[tr]
[td]中(8+3)[/td]
[td]~220[/td]
[td]推荐配置[/td]
[/tr]
[tr]
[td]高(10+5)[/td]
[td]~300[/td]
[td]标准对话[/td]
[/tr]
[tr]
[td]最大(20+10)[/td]
[td]~600[/td]
[td]深度对话[/td]
[/tr]
[/table]

[h2]系统性能影响[/h2]
[list]
[*]动态注入：~2ms/次
[*]常识库匹配：~15ms（50条）
[*]AI总结：异步执行，不阻塞主线程
[*]总体影响：可忽略
[/list]

[hr][/hr]

[h1]📝 更新日志 Changelog[/h1]

[h2]v2.4.3 (2025-01) - 最新版[/h2]
[list]
[*]✨ 新增：预览器"读取上次输入"按钮
[*]✨ 新增：双Pawn关键词提取（当前+目标）
[*]🔧 改进：上下文输入框支持测试
[*]🔧 改进：时间显示（刚刚/X分钟前/X小时前）
[*]📝 文档：DEBUGGER_VS_PREVIEWER_DIFF.md
[*]📝 文档：LOAD_LAST_INPUT_FEATURE.md
[/list]

[h2]v2.4.2 (2025-01)[/h2]
[list]
[*]🔧 改进：常识库UI可折叠区块
[*]🔧 改进：更清晰的设置界面
[*]📝 新增：中文翻译完善
[/list]

[h2]v2.4.1 (2025-01)[/h2]
[list]
[*]✨ 新增：常识库重要性参数支持
[*]✨ 新增：导出格式包含重要性
[*]🔧 改进：双重匹配机制（标签+内容）
[*]🐛 修复：关键词提取优化
[/list]

[h2]v2.4.0 (2025-01)[/h2]
[list]
[*]✨ 新增：Pawn状态常识自动生成
[*]✨ 新增：种族信息自动包含
[*]✨ 新增：7个时间段分级
[*]🔧 改进：智能内容匹配系统
[*]📝 文档：CHANGELOG_v2.4.0.md
[/list]

[h2]v2.3.0 (2024-12)[/h2]
[list]
[*]✨ 新增：动态记忆注入系统
[*]✨ 新增：通用常识库
[*]✨ 新增：注入内容预览器
[*]✨ 新增：对话缓存系统
[/list]

[hr][/hr]

[h1]🔗 链接 Links[/h1]

[list]
[*]📦 [b]GitHub[/b]: https://github.com/sanguodxj-byte/RimTalk-ExpandMemory
[*]💬 [b]Discord[/b]: [即将推出]
[*]📧 [b]反馈[/b]: GitHub Issues
[*]⭐ [b]Steam创意工坊[/b]: [订阅地址]
[/list]

[hr][/hr]

[h1]❤️ 致谢 Credits[/h1]

[list]
[*][b]灵感来源[/b]：CharacterAI, SillyTavern
[*][b]技术支持[/b]：Harmony, RimTalk
[*][b]社区反馈[/b]：RimWorld中文社区
[*][b]开发者[/b]：SANGUO
[/list]

[hr][/hr]

[b]享受游戏！Have fun![/b] 🎮✨

如有问题或建议，欢迎在GitHub Issues或Steam讨论区反馈！
If you have any questions or suggestions, feel free to post on GitHub Issues or Steam Workshop!
	</description>
	
	<modDependencies>
		<li>
			<packageId>brrainz.harmony</packageId>
			<displayName>Harmony</displayName>
			<steamWorkshopUrl>steam://url/CommunityFilePage/2009463077</steamWorkshopUrl>
		</li>
	</modDependencies>
	
	<loadAfter>
		<li>brrainz.harmony</li>
		<li>cj.rimtalk</li>
		<li>Core40k.Core</li>
		<li>RH2.Faction.Astartes</li>
		<li>OGI.Core40k</li>
	</loadAfter>
	
	<incompatibleWith>
		<!-- 如果发现与特定Mod不兼容，可以在这里列出 -->
	</incompatibleWith>
</ModMetaData>