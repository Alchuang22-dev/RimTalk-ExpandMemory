# 自动生成常识立即生成按钮 - v3.3.2.7

## ? **新功能**

为两个自动生成常识功能添加了"立即生成"按钮：

### **1. Pawn状态常识生成**
- **复选框：** 启用/禁用自动生成
- **? 立即生成按钮：** 无需等待，点击立即生成所有殖民者的状态常识

### **2. 事件记录常识生成**
- **复选框：** 启用/禁用自动生成
- **? 立即生成按钮：** 点击立即扫描最近事件并生成常识

---

## ?? **UI布局**

```
┌─────────────────────────────────────────────┐
│   自动生成                                    │
├─────────────────────────────────────────────┤
│  ? 生成Pawn状态常识         [立即生成]         │
│  ? 生成事件记录常识         [立即生成]         │
│  提示：启用自动生成后，系统会定期更新常识库       │
└─────────────────────────────────────────────┘
```

---

## ?? **功能说明**

### **Pawn状态常识生成**
**点击"立即生成"后：**
1. 检查是否启用（复选框）
2. 获取所有殖民者
3. 为每个殖民者生成状态常识
4. 显示成功消息：`成功为 X 个殖民者生成状态常识`

**生成内容示例：**
```
[Pawn/Ruma|0.8]Ruma，女性，31岁，加入基地3天，擅长烹饪15级、种植12级...
```

### **事件记录常识生成**
**点击"立即生成"后：**
1. 检查是否启用（复选框）
2. 扫描PlayLog中的最近事件
3. 生成事件记录常识
4. 显示提示：`已触发事件记录扫描，常识将自动生成到库中`

**生成内容示例：**
```
[事件|0.7]Ruma击败了海盗
[事件|0.6]基地遭受机械体袭击
```

---

## ?? **使用指南**

### **步骤1：打开常识库管理**
```
游戏主菜单 → 常识库
```

### **步骤2：展开自动生成区域**
```
点击 "? 自动生成" → " 自动生成"
```

### **步骤3：启用自动生成（可选）**
```
? 生成Pawn状态常识
? 生成事件记录常识
```

### **步骤4：立即生成**
```
点击 [立即生成] 按钮
```

### **步骤5：查看生成结果**
```
常识库列表中会显示新生成的常识
```

---

## ?? **代码实现**

### **UI布局修改**
```csharp
// 自动生成区域高度
Rect contentRect = new Rect(..., 130f); // 增加高度容纳按钮

// 第一行：Pawn状态 + 按钮
Rect pawnCheckboxRect = ... // 复选框
Rect pawnButtonRect = ...   // 立即生成按钮

// 第二行：事件记录 + 按钮
Rect eventCheckboxRect = ... // 复选框
Rect eventButtonRect = ...   // 立即生成按钮
```

### **按钮点击处理**
```csharp
if (Widgets.ButtonText(pawnButtonRect, "立即生成"))
{
    GeneratePawnStatusKnowledge(); // 调用生成方法
}

if (Widgets.ButtonText(eventButtonRect, "立即生成"))
{
    GenerateEventRecordKnowledge(); // 调用生成方法
}
```

---

## ? **优点**

### **1. 即时反馈**
- 无需等待自动生成周期
- 点击立即看到结果

### **2. 灵活控制**
- 可以随时手动触发生成
- 不影响自动生成功能

### **3. 用户友好**
- 清晰的按钮提示
- 操作简单直观

---

## ?? **版本信息**

**版本：** v3.3.2.7  
**修改文件：** `Source/Memory/UI/Dialog_CommonKnowledge.cs`  
**修改内容：**
1. 增加自动生成区域高度（100→130）
2. 添加两个"立即生成"按钮
3. 调整主窗口布局高度（140f→170f）

---

## ?? **测试建议**

### **测试1：Pawn状态常识生成**
```
1. 打开常识库管理
2. 展开自动生成区域
3. 点击 [立即生成]（Pawn状态）
4. 检查消息：成功为 X 个殖民者生成状态常识
5. 在列表中查看新常识
```

### **测试2：事件记录常识生成**
```
1. 确保有一些游戏事件发生
2. 打开常识库管理
3. 展开自动生成区域
4. 点击 [立即生成]（事件记录）
5. 检查消息提示
6. 在列表中查看新常识
```

### **测试3：UI布局**
```
1. 检查按钮是否对齐
2. 检查区域高度是否合适
3. 检查提示文字是否显示
```

---

## ?? **部署状态**

- ? 代码修改完成
- ? 编译成功
- ? DLL已部署
- ? 准备测试

**?? 现在可以重启游戏测试新功能！**
